{"ast":null,"code":"var _jsxFileName = \"/Users/ayadyousifshahi/Documents/webchat app/client/src/App.js\",\n  _window$APP_CONFIG,\n  _window$APP_CONFIG2,\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { io } from 'socket.io-client';\nimport './App.css';\nimport UserList from './components/UserList';\nimport AudioControls from './components/AudioControls';\nimport ConnectionStatus from './components/ConnectionStatus';\nimport Login from './components/Login';\nimport { WebRTCManager } from './utils/webrtcManager';\nimport QRCodeGenerator from './components/QRCodeGenerator';\nimport QRCodeScanner from './components/QRCodeScanner';\nimport { Button } from './components/ui/button';\n\n// Configuration - prioritize runtime config over environment variables\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst SERVER_URL = ((_window$APP_CONFIG = window.APP_CONFIG) === null || _window$APP_CONFIG === void 0 ? void 0 : _window$APP_CONFIG.SERVER_URL) || process.env.REACT_APP_SERVER_URL;\nconst WS_URL = ((_window$APP_CONFIG2 = window.APP_CONFIG) === null || _window$APP_CONFIG2 === void 0 ? void 0 : _window$APP_CONFIG2.WS_URL) || process.env.REACT_APP_WS_URL;\nconsole.log('Using server URL:', SERVER_URL);\nconsole.log('Using WebSocket URL:', WS_URL);\nfunction App() {\n  _s();\n  // State\n  const [socket, setSocket] = useState(null);\n  const [connected, setConnected] = useState(false);\n  const [username, setUsername] = useState('');\n  const [users, setUsers] = useState([]);\n  const [currentCall, setCurrentCall] = useState(null);\n  const [callStatus, setCallStatus] = useState('idle'); // idle, calling, connected\n  const [audioEnabled, setAudioEnabled] = useState(true);\n  const [networkQuality, setNetworkQuality] = useState(100); // 0-100\n  const [darkMode, setDarkMode] = useState(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);\n  const [showQRCode, setShowQRCode] = useState(false);\n  const [showQRScanner, setShowQRScanner] = useState(false);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [peerSpeaking, setPeerSpeaking] = useState(false);\n  const [webrtcManager, setWebrtcManager] = useState(null);\n\n  // Refs\n  const localStream = useRef(null);\n  const localAudioRef = useRef(null);\n  const remoteAudioRef = useRef(null);\n\n  // Cleanup local audio stream\n  const cleanupLocalStream = () => {\n    if (localStream.current) {\n      const tracks = localStream.current.getTracks();\n      tracks.forEach(track => track.stop());\n      localStream.current = null;\n    }\n    if (localAudioRef.current) {\n      localAudioRef.current.srcObject = null;\n    }\n  };\n\n  // Handle call end (cleanup)\n  const handleCallEnd = useCallback(() => {\n    if (webrtcManager) {\n      webrtcManager.dispose();\n      setWebrtcManager(null);\n    }\n    cleanupLocalStream();\n    setCurrentCall(null);\n    setCallStatus('idle');\n    setNetworkQuality(100);\n    setIsSpeaking(false);\n    setPeerSpeaking(false);\n  }, [webrtcManager]);\n\n  // Initialize socket connection\n  useEffect(() => {\n    if (!WS_URL) {\n      console.error('WebSocket URL is not defined');\n      return;\n    }\n    console.log('Connecting to WebSocket server at:', WS_URL);\n    const newSocket = io(WS_URL, {\n      reconnectionAttempts: 10,\n      reconnectionDelay: 1000,\n      reconnectionDelayMax: 5000,\n      timeout: 20000,\n      transports: ['websocket', 'polling']\n    });\n    setSocket(newSocket);\n\n    // Socket event listeners\n    newSocket.on('connect', () => {\n      console.log('Connected to server');\n      setConnected(true);\n    });\n    newSocket.on('disconnect', () => {\n      console.log('Disconnected from server');\n      setConnected(false);\n      handleCallEnd();\n    });\n    newSocket.on('error', error => {\n      console.error('Socket error:', error);\n      alert(`Error: ${error.message}`);\n    });\n    newSocket.on('userList', userList => {\n      setUsers(userList.filter(user => user.id !== newSocket.id));\n    });\n    newSocket.on('registered', data => {\n      console.log('Registered as:', data.username);\n      setUsername(data.username);\n    });\n\n    // WebRTC signaling events\n    newSocket.on('offer', async ({\n      from,\n      offer\n    }) => {\n      console.log('Received offer from:', from);\n\n      // If already in a call, reject\n      if (callStatus !== 'idle') {\n        newSocket.emit('busy', {\n          target: from\n        });\n        return;\n      }\n\n      // Get caller info\n      const caller = users.find(user => user.id === from);\n      if (!caller) return;\n\n      // Ask user to accept call\n      const accept = window.confirm(`Incoming call from ${caller.username}. Accept?`);\n      if (!accept) {\n        newSocket.emit('reject', {\n          target: from\n        });\n        return;\n      }\n      try {\n        // Setup WebRTC connection using enhanced manager\n        const manager = new WebRTCManager(newSocket, {\n          userId: newSocket.id,\n          onPeerConnect: (peerId, stream) => {\n            if (remoteAudioRef.current && stream) {\n              remoteAudioRef.current.srcObject = stream;\n            }\n            setCallStatus('connected');\n          },\n          onPeerDisconnect: () => {\n            handleCallEnd();\n          },\n          onSpeakingChange: speaking => {\n            setIsSpeaking(speaking);\n          },\n          onAudioQualityChange: (peerId, quality) => {\n            setNetworkQuality(Math.round(quality));\n          },\n          onError: error => {\n            console.error('WebRTC error:', error);\n            alert(`WebRTC error: ${error}`);\n          }\n        });\n        setWebrtcManager(manager);\n\n        // Initialize and accept the call\n        await manager.initialize(from);\n        await manager.acceptIncomingCall(from, offer);\n        setCurrentCall(caller);\n        setCallStatus('connected');\n      } catch (error) {\n        console.error('Error accepting call:', error);\n        alert('Failed to accept call. Please try again.');\n      }\n    });\n    newSocket.on('answer', async ({\n      from,\n      answer\n    }) => {\n      console.log('Received answer from:', from);\n      if (!webrtcManager || callStatus !== 'calling') return;\n      try {\n        await webrtcManager.handleAnswer(from, answer);\n        console.log('Remote description set successfully');\n        setCallStatus('connected');\n      } catch (error) {\n        console.error('Error setting remote description:', error);\n        handleCallEnd();\n      }\n    });\n    newSocket.on('iceCandidate', async ({\n      from,\n      candidate\n    }) => {\n      console.log('Received ICE candidate from:', from);\n      if (!webrtcManager) return;\n      try {\n        await webrtcManager.addIceCandidate(from, candidate);\n        console.log('Added ICE candidate successfully');\n      } catch (error) {\n        console.error('Error adding ICE candidate:', error);\n      }\n    });\n    newSocket.on('speaking', ({\n      userId,\n      speaking\n    }) => {\n      if (currentCall && userId === currentCall.id) {\n        setPeerSpeaking(speaking);\n      }\n    });\n    newSocket.on('reject', () => {\n      alert('Call was rejected');\n      handleCallEnd();\n    });\n    newSocket.on('busy', () => {\n      alert('User is busy');\n      handleCallEnd();\n    });\n    newSocket.on('callEnded', () => {\n      alert('Call ended by the other user');\n      handleCallEnd();\n    });\n\n    // Cleanup on unmount\n    return () => {\n      if (newSocket) {\n        newSocket.disconnect();\n      }\n      cleanupLocalStream();\n      if (webrtcManager) {\n        webrtcManager.dispose();\n      }\n    };\n  }, [callStatus, currentCall, handleCallEnd, users, webrtcManager]);\n\n  // Handle dark mode preference changes\n  useEffect(() => {\n    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n    const handleChange = e => setDarkMode(e.matches);\n    mediaQuery.addEventListener('change', handleChange);\n    return () => mediaQuery.removeEventListener('change', handleChange);\n  }, []);\n\n  // Apply dark mode class to body\n  useEffect(() => {\n    if (darkMode) {\n      document.body.classList.add('dark-mode');\n    } else {\n      document.body.classList.remove('dark-mode');\n    }\n  }, [darkMode]);\n\n  // Handle user registration\n  const handleLogin = async username => {\n    if (!socket || !connected) {\n      alert('Not connected to server');\n      return;\n    }\n    socket.emit('register', {\n      username\n    });\n  };\n\n  // Start a call with a user\n  const startCall = async targetUser => {\n    if (callStatus !== 'idle') return;\n    try {\n      // Create new WebRTC manager\n      const manager = new WebRTCManager(socket, {\n        userId: socket.id,\n        onPeerConnect: (peerId, stream) => {\n          if (remoteAudioRef.current && stream) {\n            remoteAudioRef.current.srcObject = stream;\n          }\n          setCallStatus('connected');\n        },\n        onPeerDisconnect: () => {\n          handleCallEnd();\n        },\n        onSpeakingChange: speaking => {\n          setIsSpeaking(speaking);\n        },\n        onAudioQualityChange: (peerId, quality) => {\n          setNetworkQuality(Math.round(quality));\n        },\n        onError: error => {\n          console.error('WebRTC error:', error);\n          alert(`WebRTC error: ${error}`);\n        }\n      });\n      setWebrtcManager(manager);\n\n      // Initialize and start the call\n      await manager.initialize(targetUser.id);\n      await manager.startCall(targetUser.id);\n      setCurrentCall(targetUser);\n      setCallStatus('calling');\n    } catch (error) {\n      console.error('Error starting call:', error);\n      alert('Failed to start call. Please try again.');\n      handleCallEnd();\n    }\n  };\n\n  // End the current call\n  const endCall = () => {\n    if (!socket || !currentCall) return;\n    socket.emit('callEnded', {\n      target: currentCall.id\n    });\n    handleCallEnd();\n  };\n\n  // Toggle microphone\n  const toggleMicrophone = () => {\n    if (webrtcManager) {\n      const enabled = webrtcManager.toggleMicrophone();\n      setAudioEnabled(enabled);\n    } else if (localStream.current) {\n      const audioTrack = localStream.current.getAudioTracks()[0];\n      if (audioTrack) {\n        audioTrack.enabled = !audioTrack.enabled;\n        setAudioEnabled(audioTrack.enabled);\n      }\n    }\n  };\n\n  // Toggle dark mode\n  const toggleDarkMode = () => {\n    setDarkMode(!darkMode);\n  };\n\n  // Handle QR code scan result\n  const handleQRScan = data => {\n    try {\n      const connectionData = JSON.parse(data);\n      if (connectionData.roomId && connectionData.userId) {\n        // Start call with scanned user\n        const user = {\n          id: connectionData.userId,\n          username: connectionData.username || 'User via QR'\n        };\n        startCall(user);\n        setShowQRScanner(false);\n      }\n    } catch (error) {\n      console.error('Invalid QR code data:', error);\n      alert('Invalid QR code. Please try again.');\n    }\n  };\n\n  // Generate QR code data\n  const getQRCodeData = () => {\n    return JSON.stringify({\n      roomId: socket === null || socket === void 0 ? void 0 : socket.id,\n      userId: socket === null || socket === void 0 ? void 0 : socket.id,\n      username: username\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `app ${darkMode ? 'dark-mode' : 'light-mode'}`,\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"app-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Secure Voice Chat\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"theme-toggle\",\n        onClick: toggleDarkMode,\n        \"aria-label\": darkMode ? 'Switch to light mode' : 'Switch to dark mode',\n        children: darkMode ? '☀️' : '🌙'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 369,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"app-content\",\n      children: !username ? /*#__PURE__*/_jsxDEV(Login, {\n        onLogin: handleLogin,\n        connected: connected\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(ConnectionStatus, {\n          connected: connected,\n          callStatus: callStatus,\n          currentCall: currentCall,\n          networkQuality: networkQuality,\n          isSpeaking: isSpeaking,\n          peerSpeaking: peerSpeaking\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 13\n        }, this), callStatus === 'idle' ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"connection-options\",\n          children: [/*#__PURE__*/_jsxDEV(UserList, {\n            users: users,\n            onCallUser: startCall\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"qr-options\",\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              onClick: () => setShowQRCode(!showQRCode),\n              variant: \"outline\",\n              children: showQRCode ? 'Hide QR Code' : 'Show QR Code'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 402,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              onClick: () => setShowQRScanner(!showQRScanner),\n              variant: \"outline\",\n              children: showQRScanner ? 'Hide QR Scanner' : 'Scan QR Code'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 409,\n              columnNumber: 19\n            }, this), showQRCode && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"qr-container\",\n              children: /*#__PURE__*/_jsxDEV(QRCodeGenerator, {\n                data: getQRCodeData(),\n                size: 200,\n                title: \"Scan to connect with me\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 418,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 417,\n              columnNumber: 21\n            }, this), showQRScanner && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"qr-container\",\n              children: /*#__PURE__*/_jsxDEV(QRCodeScanner, {\n                onScan: handleQRScan,\n                onError: error => console.error('QR scan error:', error),\n                onClose: () => setShowQRScanner(false)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 428,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 427,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 401,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"call-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: callStatus === 'calling' ? `Calling ${currentCall === null || currentCall === void 0 ? void 0 : currentCall.username}...` : `In call with ${currentCall === null || currentCall === void 0 ? void 0 : currentCall.username}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 439,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"speaking-indicators\",\n            children: [isSpeaking && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"speaking-indicator you\",\n              children: \"You are speaking\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 446,\n              columnNumber: 34\n            }, this), peerSpeaking && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"speaking-indicator peer\",\n              children: [currentCall === null || currentCall === void 0 ? void 0 : currentCall.username, \" is speaking\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 447,\n              columnNumber: 36\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 445,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(AudioControls, {\n            audioEnabled: audioEnabled,\n            onToggleMicrophone: toggleMicrophone,\n            onEndCall: endCall\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 450,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 438,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n      className: \"app-footer\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"End-to-end encrypted \\u2022 Zero persistence \\u2022 Local network only\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 462,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 461,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      ref: localAudioRef,\n      muted: true,\n      autoPlay: true,\n      playsInline: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 466,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      ref: remoteAudioRef,\n      autoPlay: true,\n      playsInline: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 467,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 368,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"AyT1ZqGE9CehRE31S/VJRGdCCUw=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","io","UserList","AudioControls","ConnectionStatus","Login","WebRTCManager","QRCodeGenerator","QRCodeScanner","Button","jsxDEV","_jsxDEV","Fragment","_Fragment","SERVER_URL","_window$APP_CONFIG","window","APP_CONFIG","process","env","REACT_APP_SERVER_URL","WS_URL","_window$APP_CONFIG2","REACT_APP_WS_URL","console","log","App","_s","socket","setSocket","connected","setConnected","username","setUsername","users","setUsers","currentCall","setCurrentCall","callStatus","setCallStatus","audioEnabled","setAudioEnabled","networkQuality","setNetworkQuality","darkMode","setDarkMode","matchMedia","matches","showQRCode","setShowQRCode","showQRScanner","setShowQRScanner","isSpeaking","setIsSpeaking","peerSpeaking","setPeerSpeaking","webrtcManager","setWebrtcManager","localStream","localAudioRef","remoteAudioRef","cleanupLocalStream","current","tracks","getTracks","forEach","track","stop","srcObject","handleCallEnd","dispose","error","newSocket","reconnectionAttempts","reconnectionDelay","reconnectionDelayMax","timeout","transports","on","alert","message","userList","filter","user","id","data","from","offer","emit","target","caller","find","accept","confirm","manager","userId","onPeerConnect","peerId","stream","onPeerDisconnect","onSpeakingChange","speaking","onAudioQualityChange","quality","Math","round","onError","initialize","acceptIncomingCall","answer","handleAnswer","candidate","addIceCandidate","disconnect","mediaQuery","handleChange","e","addEventListener","removeEventListener","document","body","classList","add","remove","handleLogin","startCall","targetUser","endCall","toggleMicrophone","enabled","audioTrack","getAudioTracks","toggleDarkMode","handleQRScan","connectionData","JSON","parse","roomId","getQRCodeData","stringify","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","onLogin","onCallUser","variant","size","title","onScan","onClose","onToggleMicrophone","onEndCall","ref","muted","autoPlay","playsInline","_c","$RefreshReg$"],"sources":["/Users/ayadyousifshahi/Documents/webchat app/client/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { io } from 'socket.io-client';\nimport './App.css';\nimport UserList from './components/UserList';\nimport AudioControls from './components/AudioControls';\nimport ConnectionStatus from './components/ConnectionStatus';\nimport Login from './components/Login';\nimport { WebRTCManager } from './utils/webrtcManager';\nimport QRCodeGenerator from './components/QRCodeGenerator';\nimport QRCodeScanner from './components/QRCodeScanner';\nimport { Button } from './components/ui/button';\n\n// Configuration - prioritize runtime config over environment variables\nconst SERVER_URL = window.APP_CONFIG?.SERVER_URL || process.env.REACT_APP_SERVER_URL;\nconst WS_URL = window.APP_CONFIG?.WS_URL || process.env.REACT_APP_WS_URL;\n\nconsole.log('Using server URL:', SERVER_URL);\nconsole.log('Using WebSocket URL:', WS_URL);\n\nfunction App() {\n  // State\n  const [socket, setSocket] = useState(null);\n  const [connected, setConnected] = useState(false);\n  const [username, setUsername] = useState('');\n  const [users, setUsers] = useState([]);\n  const [currentCall, setCurrentCall] = useState(null);\n  const [callStatus, setCallStatus] = useState('idle'); // idle, calling, connected\n  const [audioEnabled, setAudioEnabled] = useState(true);\n  const [networkQuality, setNetworkQuality] = useState(100); // 0-100\n  const [darkMode, setDarkMode] = useState(\n    window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches\n  );\n  const [showQRCode, setShowQRCode] = useState(false);\n  const [showQRScanner, setShowQRScanner] = useState(false);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [peerSpeaking, setPeerSpeaking] = useState(false);\n  const [webrtcManager, setWebrtcManager] = useState(null);\n  \n  // Refs\n  const localStream = useRef(null);\n  const localAudioRef = useRef(null);\n  const remoteAudioRef = useRef(null);\n  \n  // Cleanup local audio stream\n  const cleanupLocalStream = () => {\n    if (localStream.current) {\n      const tracks = localStream.current.getTracks();\n      tracks.forEach(track => track.stop());\n      localStream.current = null;\n    }\n    \n    if (localAudioRef.current) {\n      localAudioRef.current.srcObject = null;\n    }\n  };\n  \n  // Handle call end (cleanup)\n  const handleCallEnd = useCallback(() => {\n    if (webrtcManager) {\n      webrtcManager.dispose();\n      setWebrtcManager(null);\n    }\n    \n    cleanupLocalStream();\n    \n    setCurrentCall(null);\n    setCallStatus('idle');\n    setNetworkQuality(100);\n    setIsSpeaking(false);\n    setPeerSpeaking(false);\n  }, [webrtcManager]);\n  \n  // Initialize socket connection\n  useEffect(() => {\n    if (!WS_URL) {\n      console.error('WebSocket URL is not defined');\n      return;\n    }\n    \n    console.log('Connecting to WebSocket server at:', WS_URL);\n    const newSocket = io(WS_URL, {\n      reconnectionAttempts: 10,\n      reconnectionDelay: 1000,\n      reconnectionDelayMax: 5000,\n      timeout: 20000,\n      transports: ['websocket', 'polling']\n    });\n    \n    setSocket(newSocket);\n    \n    // Socket event listeners\n    newSocket.on('connect', () => {\n      console.log('Connected to server');\n      setConnected(true);\n    });\n    \n    newSocket.on('disconnect', () => {\n      console.log('Disconnected from server');\n      setConnected(false);\n      handleCallEnd();\n    });\n    \n    newSocket.on('error', (error) => {\n      console.error('Socket error:', error);\n      alert(`Error: ${error.message}`);\n    });\n    \n    newSocket.on('userList', (userList) => {\n      setUsers(userList.filter(user => user.id !== newSocket.id));\n    });\n    \n    newSocket.on('registered', (data) => {\n      console.log('Registered as:', data.username);\n      setUsername(data.username);\n    });\n    \n    // WebRTC signaling events\n    newSocket.on('offer', async ({ from, offer }) => {\n      console.log('Received offer from:', from);\n      \n      // If already in a call, reject\n      if (callStatus !== 'idle') {\n        newSocket.emit('busy', { target: from });\n        return;\n      }\n      \n      // Get caller info\n      const caller = users.find(user => user.id === from);\n      if (!caller) return;\n      \n      // Ask user to accept call\n      const accept = window.confirm(`Incoming call from ${caller.username}. Accept?`);\n      if (!accept) {\n        newSocket.emit('reject', { target: from });\n        return;\n      }\n      \n      try {\n        // Setup WebRTC connection using enhanced manager\n        const manager = new WebRTCManager(newSocket, {\n          userId: newSocket.id,\n          onPeerConnect: (peerId, stream) => {\n            if (remoteAudioRef.current && stream) {\n              remoteAudioRef.current.srcObject = stream;\n            }\n            setCallStatus('connected');\n          },\n          onPeerDisconnect: () => {\n            handleCallEnd();\n          },\n          onSpeakingChange: (speaking) => {\n            setIsSpeaking(speaking);\n          },\n          onAudioQualityChange: (peerId, quality) => {\n            setNetworkQuality(Math.round(quality));\n          },\n          onError: (error) => {\n            console.error('WebRTC error:', error);\n            alert(`WebRTC error: ${error}`);\n          }\n        });\n        \n        setWebrtcManager(manager);\n        \n        // Initialize and accept the call\n        await manager.initialize(from);\n        await manager.acceptIncomingCall(from, offer);\n        \n        setCurrentCall(caller);\n        setCallStatus('connected');\n        \n      } catch (error) {\n        console.error('Error accepting call:', error);\n        alert('Failed to accept call. Please try again.');\n      }\n    });\n    \n    newSocket.on('answer', async ({ from, answer }) => {\n      console.log('Received answer from:', from);\n      \n      if (!webrtcManager || callStatus !== 'calling') return;\n      \n      try {\n        await webrtcManager.handleAnswer(from, answer);\n        console.log('Remote description set successfully');\n        setCallStatus('connected');\n      } catch (error) {\n        console.error('Error setting remote description:', error);\n        handleCallEnd();\n      }\n    });\n    \n    newSocket.on('iceCandidate', async ({ from, candidate }) => {\n      console.log('Received ICE candidate from:', from);\n      \n      if (!webrtcManager) return;\n      \n      try {\n        await webrtcManager.addIceCandidate(from, candidate);\n        console.log('Added ICE candidate successfully');\n      } catch (error) {\n        console.error('Error adding ICE candidate:', error);\n      }\n    });\n    \n    newSocket.on('speaking', ({ userId, speaking }) => {\n      if (currentCall && userId === currentCall.id) {\n        setPeerSpeaking(speaking);\n      }\n    });\n    \n    newSocket.on('reject', () => {\n      alert('Call was rejected');\n      handleCallEnd();\n    });\n    \n    newSocket.on('busy', () => {\n      alert('User is busy');\n      handleCallEnd();\n    });\n    \n    newSocket.on('callEnded', () => {\n      alert('Call ended by the other user');\n      handleCallEnd();\n    });\n    \n    // Cleanup on unmount\n    return () => {\n      if (newSocket) {\n        newSocket.disconnect();\n      }\n      cleanupLocalStream();\n      if (webrtcManager) {\n        webrtcManager.dispose();\n      }\n    };\n  }, [callStatus, currentCall, handleCallEnd, users, webrtcManager]);\n  \n  // Handle dark mode preference changes\n  useEffect(() => {\n    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n    const handleChange = (e) => setDarkMode(e.matches);\n    \n    mediaQuery.addEventListener('change', handleChange);\n    return () => mediaQuery.removeEventListener('change', handleChange);\n  }, []);\n  \n  // Apply dark mode class to body\n  useEffect(() => {\n    if (darkMode) {\n      document.body.classList.add('dark-mode');\n    } else {\n      document.body.classList.remove('dark-mode');\n    }\n  }, [darkMode]);\n  \n  // Handle user registration\n  const handleLogin = async (username) => {\n    if (!socket || !connected) {\n      alert('Not connected to server');\n      return;\n    }\n    \n    socket.emit('register', { username });\n  };\n  \n  // Start a call with a user\n  const startCall = async (targetUser) => {\n    if (callStatus !== 'idle') return;\n    \n    try {\n      // Create new WebRTC manager\n      const manager = new WebRTCManager(socket, {\n        userId: socket.id,\n        onPeerConnect: (peerId, stream) => {\n          if (remoteAudioRef.current && stream) {\n            remoteAudioRef.current.srcObject = stream;\n          }\n          setCallStatus('connected');\n        },\n        onPeerDisconnect: () => {\n          handleCallEnd();\n        },\n        onSpeakingChange: (speaking) => {\n          setIsSpeaking(speaking);\n        },\n        onAudioQualityChange: (peerId, quality) => {\n          setNetworkQuality(Math.round(quality));\n        },\n        onError: (error) => {\n          console.error('WebRTC error:', error);\n          alert(`WebRTC error: ${error}`);\n        }\n      });\n      \n      setWebrtcManager(manager);\n      \n      // Initialize and start the call\n      await manager.initialize(targetUser.id);\n      await manager.startCall(targetUser.id);\n      \n      setCurrentCall(targetUser);\n      setCallStatus('calling');\n      \n    } catch (error) {\n      console.error('Error starting call:', error);\n      alert('Failed to start call. Please try again.');\n      handleCallEnd();\n    }\n  };\n  \n  // End the current call\n  const endCall = () => {\n    if (!socket || !currentCall) return;\n    \n    socket.emit('callEnded', { target: currentCall.id });\n    handleCallEnd();\n  };\n  \n  // Toggle microphone\n  const toggleMicrophone = () => {\n    if (webrtcManager) {\n      const enabled = webrtcManager.toggleMicrophone();\n      setAudioEnabled(enabled);\n    } else if (localStream.current) {\n      const audioTrack = localStream.current.getAudioTracks()[0];\n      if (audioTrack) {\n        audioTrack.enabled = !audioTrack.enabled;\n        setAudioEnabled(audioTrack.enabled);\n      }\n    }\n  };\n  \n  // Toggle dark mode\n  const toggleDarkMode = () => {\n    setDarkMode(!darkMode);\n  };\n  \n  // Handle QR code scan result\n  const handleQRScan = (data) => {\n    try {\n      const connectionData = JSON.parse(data);\n      if (connectionData.roomId && connectionData.userId) {\n        // Start call with scanned user\n        const user = {\n          id: connectionData.userId,\n          username: connectionData.username || 'User via QR'\n        };\n        startCall(user);\n        setShowQRScanner(false);\n      }\n    } catch (error) {\n      console.error('Invalid QR code data:', error);\n      alert('Invalid QR code. Please try again.');\n    }\n  };\n  \n  // Generate QR code data\n  const getQRCodeData = () => {\n    return JSON.stringify({\n      roomId: socket?.id,\n      userId: socket?.id,\n      username: username\n    });\n  };\n  \n  return (\n    <div className={`app ${darkMode ? 'dark-mode' : 'light-mode'}`}>\n      <header className=\"app-header\">\n        <h1>Secure Voice Chat</h1>\n        <button \n          className=\"theme-toggle\" \n          onClick={toggleDarkMode} \n          aria-label={darkMode ? 'Switch to light mode' : 'Switch to dark mode'}\n        >\n          {darkMode ? '☀️' : '🌙'}\n        </button>\n      </header>\n      \n      <main className=\"app-content\">\n        {!username ? (\n          <Login onLogin={handleLogin} connected={connected} />\n        ) : (\n          <>\n            <ConnectionStatus \n              connected={connected} \n              callStatus={callStatus} \n              currentCall={currentCall}\n              networkQuality={networkQuality}\n              isSpeaking={isSpeaking}\n              peerSpeaking={peerSpeaking}\n            />\n            \n            {callStatus === 'idle' ? (\n              <div className=\"connection-options\">\n                <UserList \n                  users={users} \n                  onCallUser={startCall} \n                />\n                \n                <div className=\"qr-options\">\n                  <Button \n                    onClick={() => setShowQRCode(!showQRCode)}\n                    variant=\"outline\"\n                  >\n                    {showQRCode ? 'Hide QR Code' : 'Show QR Code'}\n                  </Button>\n                  \n                  <Button \n                    onClick={() => setShowQRScanner(!showQRScanner)}\n                    variant=\"outline\"\n                  >\n                    {showQRScanner ? 'Hide QR Scanner' : 'Scan QR Code'}\n                  </Button>\n                  \n                  {showQRCode && (\n                    <div className=\"qr-container\">\n                      <QRCodeGenerator \n                        data={getQRCodeData()} \n                        size={200}\n                        title=\"Scan to connect with me\"\n                      />\n                    </div>\n                  )}\n                  \n                  {showQRScanner && (\n                    <div className=\"qr-container\">\n                      <QRCodeScanner \n                        onScan={handleQRScan}\n                        onError={(error) => console.error('QR scan error:', error)}\n                        onClose={() => setShowQRScanner(false)}\n                      />\n                    </div>\n                  )}\n                </div>\n              </div>\n            ) : (\n              <div className=\"call-container\">\n                <h2>\n                  {callStatus === 'calling' \n                    ? `Calling ${currentCall?.username}...` \n                    : `In call with ${currentCall?.username}`}\n                </h2>\n                \n                <div className=\"speaking-indicators\">\n                  {isSpeaking && <div className=\"speaking-indicator you\">You are speaking</div>}\n                  {peerSpeaking && <div className=\"speaking-indicator peer\">{currentCall?.username} is speaking</div>}\n                </div>\n                \n                <AudioControls \n                  audioEnabled={audioEnabled} \n                  onToggleMicrophone={toggleMicrophone} \n                  onEndCall={endCall} \n                />\n              </div>\n            )}\n          </>\n        )}\n      </main>\n      \n      <footer className=\"app-footer\">\n        <p>End-to-end encrypted • Zero persistence • Local network only</p>\n      </footer>\n      \n      {/* Hidden audio elements */}\n      <audio ref={localAudioRef} muted autoPlay playsInline />\n      <audio ref={remoteAudioRef} autoPlay playsInline />\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}