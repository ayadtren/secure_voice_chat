{"ast":null,"code":"var _jsxFileName = \"/Users/ayadyousifshahi/Documents/webchat app/client/src/components/VideoChatRoom.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { io } from 'socket.io-client';\nimport { WebRTCManager } from '../utils/webrtcManager';\nimport { clsx } from 'clsx';\nimport { cn } from '../lib/utils';\nimport QRCodeGenerator from './QRCodeGenerator';\nimport VideoContainer from './VideoContainer';\nimport VideoControls from './VideoControls';\nimport CameraPermissionGuide from './CameraPermissionGuide';\nimport VideoQualityControls from './VideoQualityControls';\nimport NetworkQualityIndicator from './NetworkQualityIndicator';\nimport ScreenShareButton from './ScreenShareButton';\n\n/**\n * VideoChatRoom Component\n * \n * Main component for the video/voice chat room functionality.\n * Handles WebRTC connections, audio/video processing, and UI for the chat.\n */\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst VideoChatRoom = ({\n  roomId,\n  userId,\n  onLeave\n}) => {\n  _s();\n  var _cameraStatus$browser;\n  const [socket, setSocket] = useState(null);\n  const [webrtcManager, setWebrtcManager] = useState(null);\n  const [connectedPeers, setConnectedPeers] = useState([]);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [peerSpeaking, setPeerSpeaking] = useState({});\n  const [audioLevels, setAudioLevels] = useState({});\n  const [connectionQualities, setConnectionQualities] = useState({});\n  const [error, setError] = useState(null);\n  const [isConnecting, setIsConnecting] = useState(true);\n  const [showQRCode, setShowQRCode] = useState(false);\n\n  // Video-related state\n  const [isVideoEnabled, setIsVideoEnabled] = useState(false);\n  const [videoDevices, setVideoDevices] = useState([]);\n  const [cameraStatus, setCameraStatus] = useState(null);\n  const [localVideoStream, setLocalVideoStream] = useState(null);\n  const [remoteVideoStreams, setRemoteVideoStreams] = useState({});\n\n  // Phase 2 features - Video quality and network monitoring\n  const [currentVideoQuality, setCurrentVideoQuality] = useState('high');\n  const [networkQuality, setNetworkQuality] = useState(100);\n  const [networkMetrics, setNetworkMetrics] = useState(null);\n\n  // Phase 3 features - Screen sharing\n  const [isScreenSharing, setIsScreenSharing] = useState(false);\n  const [screenStream, setScreenStream] = useState(null);\n\n  // References\n  const audioRefs = useRef({});\n  const animationFrameRef = useRef(null);\n\n  // Initialize socket and WebRTC manager\n  useEffect(() => {\n    // Create socket connection to signaling server\n    const newSocket = io(process.env.REACT_APP_SIGNALING_SERVER || window.location.origin, {\n      path: '/socket.io',\n      transports: ['websocket'],\n      secure: window.location.protocol === 'https:',\n      reconnection: true,\n      reconnectionAttempts: 5,\n      reconnectionDelay: 1000\n    });\n    setSocket(newSocket);\n\n    // Socket event handlers\n    newSocket.on('connect', () => {\n      console.log('Connected to signaling server');\n    });\n    newSocket.on('connect_error', err => {\n      console.error('Connection error:', err);\n      setError('Failed to connect to the signaling server. Please try again.');\n    });\n\n    // Clean up on unmount\n    return () => {\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n      }\n      newSocket.disconnect();\n    };\n  }, []);\n\n  // Initialize WebRTC manager when socket is ready\n  useEffect(() => {\n    if (!socket || !roomId) return;\n    const manager = new WebRTCManager(socket, {\n      userId,\n      onPeerConnect: handlePeerConnect,\n      onPeerDisconnect: handlePeerDisconnect,\n      onSpeakingChange: handleSpeakingChange,\n      onAudioQualityChange: handleAudioQualityChange,\n      onError: errorMsg => setError(errorMsg),\n      onMicrophoneStatus: handleMicrophoneStatus,\n      onCameraStatus: handleCameraStatus,\n      onLocalVideo: handleLocalVideo,\n      onRemoteVideo: handleRemoteVideo,\n      onVideoStatusChange: handleVideoStatusChange,\n      onNetworkQualityChange: handleNetworkQualityChange,\n      // Phase 2 - Network quality monitoring\n      onScreenSharingChange: handleScreenSharingChange // Phase 3 - Screen sharing\n    });\n    setWebrtcManager(manager);\n\n    // Initialize WebRTC and join room\n    manager.initialize(roomId).then(() => {\n      setIsConnecting(false);\n      startAudioLevelMonitoring(manager);\n\n      // Get available video devices\n      manager.getVideoDevices().then(devices => {\n        setVideoDevices(devices);\n      });\n\n      // Set initial video quality (Phase 2)\n      if (manager.setVideoQuality) {\n        manager.setVideoQuality(currentVideoQuality);\n      }\n    }).catch(err => {\n      console.error('Failed to initialize WebRTC:', err);\n      setError('Failed to access microphone. Please check your permissions.');\n      setIsConnecting(false);\n    });\n\n    // Clean up on unmount\n    return () => {\n      if (manager) {\n        manager.dispose();\n      }\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n      }\n    };\n  }, [socket, roomId, userId]);\n\n  // Handle peer connection\n  const handlePeerConnect = (peerId, stream) => {\n    console.log(`Peer connected: ${peerId}`);\n\n    // Add to connected peers\n    setConnectedPeers(prevPeers => {\n      if (!prevPeers.includes(peerId)) {\n        return [...prevPeers, peerId];\n      }\n      return prevPeers;\n    });\n\n    // Create audio element for peer\n    if (stream) {\n      const audioElement = new Audio();\n      audioElement.srcObject = stream;\n      audioElement.autoplay = true;\n\n      // Store audio element reference\n      audioRefs.current[peerId] = audioElement;\n\n      // Start playing\n      audioElement.play().catch(err => {\n        console.error('Error playing audio:', err);\n      });\n    }\n  };\n\n  // Handle peer disconnection\n  const handlePeerDisconnect = peerId => {\n    console.log(`Peer disconnected: ${peerId}`);\n\n    // Remove from connected peers\n    setConnectedPeers(prevPeers => prevPeers.filter(id => id !== peerId));\n\n    // Remove speaking status\n    setPeerSpeaking(prevState => {\n      const newState = {\n        ...prevState\n      };\n      delete newState[peerId];\n      return newState;\n    });\n\n    // Remove audio levels\n    setAudioLevels(prevLevels => {\n      const newLevels = {\n        ...prevLevels\n      };\n      delete newLevels[peerId];\n      return newLevels;\n    });\n\n    // Remove connection quality\n    setConnectionQualities(prevQualities => {\n      const newQualities = {\n        ...prevQualities\n      };\n      delete newQualities[peerId];\n      return newQualities;\n    });\n\n    // Remove video stream\n    setRemoteVideoStreams(prevStreams => {\n      const newStreams = {\n        ...prevStreams\n      };\n      delete newStreams[peerId];\n      return newStreams;\n    });\n\n    // Clean up audio element\n    if (audioRefs.current[peerId]) {\n      audioRefs.current[peerId].srcObject = null;\n      delete audioRefs.current[peerId];\n    }\n  };\n\n  // Handle speaking change\n  const handleSpeakingChange = speaking => {\n    setIsSpeaking(speaking);\n  };\n\n  // Handle remote peer speaking change\n  const handlePeerSpeakingChange = (peerId, speaking) => {\n    setPeerSpeaking(prevState => ({\n      ...prevState,\n      [peerId]: speaking\n    }));\n  };\n\n  // Handle audio quality change\n  const handleAudioQualityChange = (peerId, quality, metrics) => {\n    setConnectionQualities(prevQualities => ({\n      ...prevQualities,\n      [peerId]: {\n        quality,\n        metrics\n      }\n    }));\n  };\n\n  // Handle microphone status change\n  const handleMicrophoneStatus = status => {\n    // This can be used to show microphone permission UI if needed\n    console.log('Microphone status:', status);\n  };\n\n  // Handle camera status change\n  const handleCameraStatus = status => {\n    setCameraStatus(status);\n  };\n\n  // Handle local video stream\n  const handleLocalVideo = stream => {\n    setLocalVideoStream(stream);\n  };\n\n  // Handle remote video stream\n  const handleRemoteVideo = (peerId, stream) => {\n    setRemoteVideoStreams(prevStreams => ({\n      ...prevStreams,\n      [peerId]: stream\n    }));\n  };\n\n  // Handle video status change\n  const handleVideoStatusChange = enabled => {\n    setIsVideoEnabled(enabled);\n  };\n\n  // Handle network quality change\n  const handleNetworkQualityChange = (quality, metrics) => {\n    setNetworkQuality(quality);\n    setNetworkMetrics(metrics);\n  };\n\n  // Handle video quality change (Phase 2)\n  const handleVideoQualityChange = qualityPreset => {\n    if (webrtcManager && webrtcManager.setVideoQuality) {\n      webrtcManager.setVideoQuality(qualityPreset.id);\n      setCurrentVideoQuality(qualityPreset.id);\n    }\n  };\n\n  // Start monitoring audio levels\n  const startAudioLevelMonitoring = manager => {\n    const updateAudioLevels = () => {\n      if (!manager) return;\n\n      // Update local audio level\n      const localLevel = manager.getAudioLevel();\n      setAudioLevels(prevLevels => ({\n        ...prevLevels,\n        local: localLevel\n      }));\n\n      // Continue monitoring\n      animationFrameRef.current = requestAnimationFrame(updateAudioLevels);\n    };\n\n    // Start monitoring\n    updateAudioLevels();\n  };\n\n  // Toggle mute\n  const handleToggleMute = () => {\n    if (webrtcManager) {\n      const newMuteState = webrtcManager.toggleMute();\n      setIsMuted(newMuteState);\n    }\n  };\n\n  // Toggle video\n  const handleToggleVideo = async () => {\n    if (webrtcManager) {\n      const videoEnabled = await webrtcManager.toggleVideo();\n      setIsVideoEnabled(videoEnabled);\n    }\n  };\n\n  // Switch camera\n  const handleSwitchCamera = async deviceId => {\n    if (webrtcManager) {\n      await webrtcManager.switchCamera(deviceId);\n    }\n  };\n\n  // Retry camera access\n  const handleRetryCameraAccess = async () => {\n    if (webrtcManager) {\n      const videoEnabled = await webrtcManager.toggleVideo();\n      setIsVideoEnabled(videoEnabled);\n    }\n  };\n\n  // Leave room\n  const handleLeaveRoom = () => {\n    if (webrtcManager) {\n      webrtcManager.leaveRoom();\n    }\n    if (onLeave) {\n      onLeave();\n    }\n  };\n\n  // Toggle QR code display\n  const handleToggleQRCode = () => {\n    setShowQRCode(prev => !prev);\n  };\n\n  // Generate connection data for QR code\n  const getConnectionData = () => {\n    return JSON.stringify({\n      roomId,\n      server: window.location.origin\n    });\n  };\n\n  // Calculate grid columns based on number of participants\n  const getGridColumns = () => {\n    const totalParticipants = 1 + connectedPeers.length; // Local user + peers\n\n    if (totalParticipants === 1) return 'grid-cols-1';\n    if (totalParticipants === 2) return 'grid-cols-1 md:grid-cols-2';\n    if (totalParticipants <= 4) return 'grid-cols-2';\n    if (totalParticipants <= 6) return 'grid-cols-2 md:grid-cols-3';\n    return 'grid-cols-2 md:grid-cols-3 lg:grid-cols-4';\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col h-full bg-gradient-to-b from-white to-gray-50\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between p-4 border-b border-gray-200 bg-white shadow-sm\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-lg font-medium text-gray-900\",\n          children: [\"Room: \", roomId]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500\",\n          children: [connectedPeers.length, \" \", connectedPeers.length === 1 ? 'peer' : 'peers', \" connected\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center ml-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm text-gray-500 mr-2\",\n            children: \"Network:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(NetworkQualityIndicator, {\n            quality: networkQuality\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 375,\n            columnNumber: 13\n          }, this), networkMetrics && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"ml-2 text-xs text-gray-500\",\n            children: [networkMetrics.bitrate ? `${Math.round(networkMetrics.bitrate / 1000)} kbps` : '', networkMetrics.rtt ? ` | ${Math.round(networkMetrics.rtt)}ms` : '']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 377,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleToggleQRCode,\n          className: clsx('inline-flex items-center justify-center px-2 py-[calc(--spacing(1.5)-1px)]', 'rounded-lg border border-transparent ring-1 shadow-sm ring-black/10', 'text-sm font-medium whitespace-nowrap text-gray-950', 'data-hover:bg-gray-50'),\n          \"aria-label\": showQRCode ? \"Hide QR code\" : \"Show QR code for connection\",\n          children: showQRCode ? \"Hide QR\" : \"Show QR\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleToggleMute,\n          className: clsx('inline-flex items-center justify-center px-4 py-[calc(--spacing(2)-1px)]', 'rounded-full border border-transparent shadow-md', 'text-base font-medium whitespace-nowrap', isMuted ? 'bg-white/15 ring-1 ring-[#D15052]/15 text-gray-950 data-hover:bg-white/20' : 'bg-gray-950 text-white data-hover:bg-gray-800', 'after:absolute after:inset-0 after:rounded-full after:shadow-[inset_0_0_2px_1px_#ffffff4d]'),\n          \"aria-label\": isMuted ? \"Unmute microphone\" : \"Mute microphone\",\n          children: isMuted ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              xmlns: \"http://www.w3.org/2000/svg\",\n              viewBox: \"0 0 24 24\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              strokeWidth: \"2\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              className: \"w-5 h-5 mr-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"line\", {\n                x1: \"1\",\n                y1: \"1\",\n                x2: \"23\",\n                y2: \"23\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 415,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 416,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 417,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                x1: \"12\",\n                y1: \"19\",\n                x2: \"12\",\n                y2: \"23\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 418,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                x1: \"8\",\n                y1: \"23\",\n                x2: \"16\",\n                y2: \"23\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 419,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 414,\n              columnNumber: 17\n            }, this), \"Unmute\"]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              xmlns: \"http://www.w3.org/2000/svg\",\n              viewBox: \"0 0 24 24\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              strokeWidth: \"2\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              className: \"w-5 h-5 mr-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 426,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M19 10v2a7 7 0 0 1-14 0v-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 427,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                x1: \"12\",\n                y1: \"19\",\n                x2: \"12\",\n                y2: \"23\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 428,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                x1: \"8\",\n                y1: \"23\",\n                x2: \"16\",\n                y2: \"23\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 429,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 425,\n              columnNumber: 17\n            }, this), \"Mute\"]\n          }, void 0, true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(VideoControls, {\n          isVideoEnabled: isVideoEnabled,\n          onToggleVideo: handleToggleVideo,\n          onSwitchCamera: handleSwitchCamera,\n          videoDevices: videoDevices\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(VideoQualityControls, {\n          currentQuality: currentVideoQuality,\n          onQualityChange: handleVideoQualityChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 443,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLeaveRoom,\n          className: clsx('inline-flex items-center justify-center px-4 py-[calc(--spacing(2)-1px)]', 'rounded-full border border-transparent bg-[#D15052] shadow-md', 'text-base font-medium whitespace-nowrap text-white', 'data-hover:bg-[#C04042]'),\n          \"aria-label\": \"Leave chat room\",\n          children: \"Leave\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 385,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 p-4 overflow-auto\",\n      children: isConnecting ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col items-center justify-center h-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-lg font-medium mb-2 text-gray-900\",\n          children: \"Connecting...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500\",\n          children: \"Setting up secure connection\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 466,\n        columnNumber: 11\n      }, this) : error ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col items-center justify-center h-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-lg font-medium text-[#D15052] mb-2\",\n          children: \"Error\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 474,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500 mb-4\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 475,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLeaveRoom,\n          className: clsx('inline-flex items-center justify-center px-4 py-[calc(--spacing(2)-1px)]', 'rounded-full border border-transparent bg-gray-950 shadow-md', 'text-base font-medium whitespace-nowrap text-white', 'data-hover:bg-gray-800'),\n          children: \"Go Back\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 476,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 473,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col space-y-4\",\n        children: [showQRCode && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white p-6 rounded-xl shadow-md mx-auto max-w-xs\",\n          children: [/*#__PURE__*/_jsxDEV(QRCodeGenerator, {\n            connectionData: getConnectionData(),\n            className: \"mx-auto\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 493,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-center mt-4 text-sm text-gray-500\",\n            children: \"Scan to join this room\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 497,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 492,\n          columnNumber: 15\n        }, this), cameraStatus && cameraStatus.status !== 'granted' && isVideoEnabled && /*#__PURE__*/_jsxDEV(CameraPermissionGuide, {\n          status: cameraStatus.status,\n          instructions: cameraStatus.instructions,\n          browser: (_cameraStatus$browser = cameraStatus.browser) === null || _cameraStatus$browser === void 0 ? void 0 : _cameraStatus$browser.name,\n          onRetry: handleRetryCameraAccess,\n          className: \"mx-auto max-w-md\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 505,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: clsx('grid gap-4', getGridColumns(), 'auto-rows-fr'),\n          children: [/*#__PURE__*/_jsxDEV(VideoContainer, {\n            stream: localVideoStream,\n            isMuted: true,\n            isLocal: true,\n            displayName: userId,\n            isSpeaking: isSpeaking,\n            isVideoEnabled: isVideoEnabled && localVideoStream !== null,\n            connectionQuality: networkQuality,\n            className: \"aspect-video h-full\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 521,\n            columnNumber: 15\n          }, this), connectedPeers.map(peerId => {\n            var _connectionQualities$;\n            return /*#__PURE__*/_jsxDEV(VideoContainer, {\n              stream: remoteVideoStreams[peerId],\n              isMuted: false,\n              isLocal: false,\n              displayName: peerId,\n              isSpeaking: peerSpeaking[peerId] || false,\n              isVideoEnabled: remoteVideoStreams[peerId] !== undefined,\n              connectionQuality: ((_connectionQualities$ = connectionQualities[peerId]) === null || _connectionQualities$ === void 0 ? void 0 : _connectionQualities$.quality) || 100,\n              className: \"aspect-video h-full\"\n            }, peerId, false, {\n              fileName: _jsxFileName,\n              lineNumber: 534,\n              columnNumber: 17\n            }, this);\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 515,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 489,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 464,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 364,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoChatRoom, \"XvoV4nSCskFSc56OWO7cj5KlNys=\");\n_c = VideoChatRoom;\nexport default VideoChatRoom;\n\n// Handle screen sharing change (Phase 3)\nconst handleScreenSharingChange = (isSharing, stream) => {\n  setIsScreenSharing(isSharing);\n  setScreenStream(stream);\n};\n\n// Handle toggle screen sharing\nconst handleToggleScreenShare = async () => {\n  if (webrtcManager) {\n    await webrtcManager.toggleScreenSharing();\n  }\n};\nvar _c;\n$RefreshReg$(_c, \"VideoChatRoom\");","map":{"version":3,"names":["React","useState","useEffect","useRef","io","WebRTCManager","clsx","cn","QRCodeGenerator","VideoContainer","VideoControls","CameraPermissionGuide","VideoQualityControls","NetworkQualityIndicator","ScreenShareButton","jsxDEV","_jsxDEV","Fragment","_Fragment","VideoChatRoom","roomId","userId","onLeave","_s","_cameraStatus$browser","socket","setSocket","webrtcManager","setWebrtcManager","connectedPeers","setConnectedPeers","isMuted","setIsMuted","isSpeaking","setIsSpeaking","peerSpeaking","setPeerSpeaking","audioLevels","setAudioLevels","connectionQualities","setConnectionQualities","error","setError","isConnecting","setIsConnecting","showQRCode","setShowQRCode","isVideoEnabled","setIsVideoEnabled","videoDevices","setVideoDevices","cameraStatus","setCameraStatus","localVideoStream","setLocalVideoStream","remoteVideoStreams","setRemoteVideoStreams","currentVideoQuality","setCurrentVideoQuality","networkQuality","setNetworkQuality","networkMetrics","setNetworkMetrics","isScreenSharing","setIsScreenSharing","screenStream","setScreenStream","audioRefs","animationFrameRef","newSocket","process","env","REACT_APP_SIGNALING_SERVER","window","location","origin","path","transports","secure","protocol","reconnection","reconnectionAttempts","reconnectionDelay","on","console","log","err","current","cancelAnimationFrame","disconnect","manager","onPeerConnect","handlePeerConnect","onPeerDisconnect","handlePeerDisconnect","onSpeakingChange","handleSpeakingChange","onAudioQualityChange","handleAudioQualityChange","onError","errorMsg","onMicrophoneStatus","handleMicrophoneStatus","onCameraStatus","handleCameraStatus","onLocalVideo","handleLocalVideo","onRemoteVideo","handleRemoteVideo","onVideoStatusChange","handleVideoStatusChange","onNetworkQualityChange","handleNetworkQualityChange","onScreenSharingChange","handleScreenSharingChange","initialize","then","startAudioLevelMonitoring","getVideoDevices","devices","setVideoQuality","catch","dispose","peerId","stream","prevPeers","includes","audioElement","Audio","srcObject","autoplay","play","filter","id","prevState","newState","prevLevels","newLevels","prevQualities","newQualities","prevStreams","newStreams","speaking","handlePeerSpeakingChange","quality","metrics","status","enabled","handleVideoQualityChange","qualityPreset","updateAudioLevels","localLevel","getAudioLevel","local","requestAnimationFrame","handleToggleMute","newMuteState","toggleMute","handleToggleVideo","videoEnabled","toggleVideo","handleSwitchCamera","deviceId","switchCamera","handleRetryCameraAccess","handleLeaveRoom","leaveRoom","handleToggleQRCode","prev","getConnectionData","JSON","stringify","server","getGridColumns","totalParticipants","length","className","children","fileName","_jsxFileName","lineNumber","columnNumber","bitrate","Math","round","rtt","onClick","xmlns","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","x1","y1","x2","y2","d","onToggleVideo","onSwitchCamera","currentQuality","onQualityChange","connectionData","instructions","browser","name","onRetry","isLocal","displayName","connectionQuality","map","_connectionQualities$","undefined","_c","isSharing","handleToggleScreenShare","toggleScreenSharing","$RefreshReg$"],"sources":["/Users/ayadyousifshahi/Documents/webchat app/client/src/components/VideoChatRoom.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { io } from 'socket.io-client';\nimport { WebRTCManager } from '../utils/webrtcManager';\nimport { clsx } from 'clsx';\nimport { cn } from '../lib/utils';\nimport QRCodeGenerator from './QRCodeGenerator';\nimport VideoContainer from './VideoContainer';\nimport VideoControls from './VideoControls';\nimport CameraPermissionGuide from './CameraPermissionGuide';\nimport VideoQualityControls from './VideoQualityControls';\nimport NetworkQualityIndicator from './NetworkQualityIndicator';\nimport ScreenShareButton from './ScreenShareButton';\n\n/**\n * VideoChatRoom Component\n * \n * Main component for the video/voice chat room functionality.\n * Handles WebRTC connections, audio/video processing, and UI for the chat.\n */\nconst VideoChatRoom = ({ roomId, userId, onLeave }) => {\n  const [socket, setSocket] = useState(null);\n  const [webrtcManager, setWebrtcManager] = useState(null);\n  const [connectedPeers, setConnectedPeers] = useState([]);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [peerSpeaking, setPeerSpeaking] = useState({});\n  const [audioLevels, setAudioLevels] = useState({});\n  const [connectionQualities, setConnectionQualities] = useState({});\n  const [error, setError] = useState(null);\n  const [isConnecting, setIsConnecting] = useState(true);\n  const [showQRCode, setShowQRCode] = useState(false);\n  \n  // Video-related state\n  const [isVideoEnabled, setIsVideoEnabled] = useState(false);\n  const [videoDevices, setVideoDevices] = useState([]);\n  const [cameraStatus, setCameraStatus] = useState(null);\n  const [localVideoStream, setLocalVideoStream] = useState(null);\n  const [remoteVideoStreams, setRemoteVideoStreams] = useState({});\n  \n  // Phase 2 features - Video quality and network monitoring\n  const [currentVideoQuality, setCurrentVideoQuality] = useState('high');\n  const [networkQuality, setNetworkQuality] = useState(100);\n  const [networkMetrics, setNetworkMetrics] = useState(null);\n  \n  // Phase 3 features - Screen sharing\n  const [isScreenSharing, setIsScreenSharing] = useState(false);\n  const [screenStream, setScreenStream] = useState(null);\n  \n  // References\n  const audioRefs = useRef({});\n  const animationFrameRef = useRef(null);\n  \n  // Initialize socket and WebRTC manager\n  useEffect(() => {\n    // Create socket connection to signaling server\n    const newSocket = io(process.env.REACT_APP_SIGNALING_SERVER || window.location.origin, {\n      path: '/socket.io',\n      transports: ['websocket'],\n      secure: window.location.protocol === 'https:',\n      reconnection: true,\n      reconnectionAttempts: 5,\n      reconnectionDelay: 1000,\n    });\n    \n    setSocket(newSocket);\n    \n    // Socket event handlers\n    newSocket.on('connect', () => {\n      console.log('Connected to signaling server');\n    });\n    \n    newSocket.on('connect_error', (err) => {\n      console.error('Connection error:', err);\n      setError('Failed to connect to the signaling server. Please try again.');\n    });\n    \n    // Clean up on unmount\n    return () => {\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n      }\n      \n      newSocket.disconnect();\n    };\n  }, []);\n  \n  // Initialize WebRTC manager when socket is ready\n  useEffect(() => {\n    if (!socket || !roomId) return;\n    \n    const manager = new WebRTCManager(socket, {\n      userId,\n      onPeerConnect: handlePeerConnect,\n      onPeerDisconnect: handlePeerDisconnect,\n      onSpeakingChange: handleSpeakingChange,\n      onAudioQualityChange: handleAudioQualityChange,\n      onError: (errorMsg) => setError(errorMsg),\n      onMicrophoneStatus: handleMicrophoneStatus,\n      onCameraStatus: handleCameraStatus,\n      onLocalVideo: handleLocalVideo,\n      onRemoteVideo: handleRemoteVideo,\n      onVideoStatusChange: handleVideoStatusChange,\n      onNetworkQualityChange: handleNetworkQualityChange, // Phase 2 - Network quality monitoring\n      onScreenSharingChange: handleScreenSharingChange, // Phase 3 - Screen sharing\n    });\n    \n    setWebrtcManager(manager);\n    \n    // Initialize WebRTC and join room\n    manager.initialize(roomId)\n      .then(() => {\n        setIsConnecting(false);\n        startAudioLevelMonitoring(manager);\n        \n        // Get available video devices\n        manager.getVideoDevices().then(devices => {\n          setVideoDevices(devices);\n        });\n        \n        // Set initial video quality (Phase 2)\n        if (manager.setVideoQuality) {\n          manager.setVideoQuality(currentVideoQuality);\n        }\n      })\n      .catch((err) => {\n        console.error('Failed to initialize WebRTC:', err);\n        setError('Failed to access microphone. Please check your permissions.');\n        setIsConnecting(false);\n      });\n    \n    // Clean up on unmount\n    return () => {\n      if (manager) {\n        manager.dispose();\n      }\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n      }\n    };\n  }, [socket, roomId, userId]);\n  \n  // Handle peer connection\n  const handlePeerConnect = (peerId, stream) => {\n    console.log(`Peer connected: ${peerId}`);\n    \n    // Add to connected peers\n    setConnectedPeers((prevPeers) => {\n      if (!prevPeers.includes(peerId)) {\n        return [...prevPeers, peerId];\n      }\n      return prevPeers;\n    });\n    \n    // Create audio element for peer\n    if (stream) {\n      const audioElement = new Audio();\n      audioElement.srcObject = stream;\n      audioElement.autoplay = true;\n      \n      // Store audio element reference\n      audioRefs.current[peerId] = audioElement;\n      \n      // Start playing\n      audioElement.play().catch((err) => {\n        console.error('Error playing audio:', err);\n      });\n    }\n  };\n  \n  // Handle peer disconnection\n  const handlePeerDisconnect = (peerId) => {\n    console.log(`Peer disconnected: ${peerId}`);\n    \n    // Remove from connected peers\n    setConnectedPeers((prevPeers) => prevPeers.filter((id) => id !== peerId));\n    \n    // Remove speaking status\n    setPeerSpeaking((prevState) => {\n      const newState = { ...prevState };\n      delete newState[peerId];\n      return newState;\n    });\n    \n    // Remove audio levels\n    setAudioLevels((prevLevels) => {\n      const newLevels = { ...prevLevels };\n      delete newLevels[peerId];\n      return newLevels;\n    });\n    \n    // Remove connection quality\n    setConnectionQualities((prevQualities) => {\n      const newQualities = { ...prevQualities };\n      delete newQualities[peerId];\n      return newQualities;\n    });\n    \n    // Remove video stream\n    setRemoteVideoStreams((prevStreams) => {\n      const newStreams = { ...prevStreams };\n      delete newStreams[peerId];\n      return newStreams;\n    });\n    \n    // Clean up audio element\n    if (audioRefs.current[peerId]) {\n      audioRefs.current[peerId].srcObject = null;\n      delete audioRefs.current[peerId];\n    }\n  };\n  \n  // Handle speaking change\n  const handleSpeakingChange = (speaking) => {\n    setIsSpeaking(speaking);\n  };\n  \n  // Handle remote peer speaking change\n  const handlePeerSpeakingChange = (peerId, speaking) => {\n    setPeerSpeaking((prevState) => ({\n      ...prevState,\n      [peerId]: speaking,\n    }));\n  };\n  \n  // Handle audio quality change\n  const handleAudioQualityChange = (peerId, quality, metrics) => {\n    setConnectionQualities((prevQualities) => ({\n      ...prevQualities,\n      [peerId]: { quality, metrics },\n    }));\n  };\n  \n  // Handle microphone status change\n  const handleMicrophoneStatus = (status) => {\n    // This can be used to show microphone permission UI if needed\n    console.log('Microphone status:', status);\n  };\n  \n  // Handle camera status change\n  const handleCameraStatus = (status) => {\n    setCameraStatus(status);\n  };\n  \n  // Handle local video stream\n  const handleLocalVideo = (stream) => {\n    setLocalVideoStream(stream);\n  };\n  \n  // Handle remote video stream\n  const handleRemoteVideo = (peerId, stream) => {\n    setRemoteVideoStreams((prevStreams) => ({\n      ...prevStreams,\n      [peerId]: stream,\n    }));\n  };\n  \n  // Handle video status change\n  const handleVideoStatusChange = (enabled) => {\n    setIsVideoEnabled(enabled);\n  };\n  \n  // Handle network quality change\n  const handleNetworkQualityChange = (quality, metrics) => {\n    setNetworkQuality(quality);\n    setNetworkMetrics(metrics);\n  };\n  \n  // Handle video quality change (Phase 2)\n  const handleVideoQualityChange = (qualityPreset) => {\n    if (webrtcManager && webrtcManager.setVideoQuality) {\n      webrtcManager.setVideoQuality(qualityPreset.id);\n      setCurrentVideoQuality(qualityPreset.id);\n    }\n  };\n  \n  // Start monitoring audio levels\n  const startAudioLevelMonitoring = (manager) => {\n    const updateAudioLevels = () => {\n      if (!manager) return;\n      \n      // Update local audio level\n      const localLevel = manager.getAudioLevel();\n      \n      setAudioLevels((prevLevels) => ({\n        ...prevLevels,\n        local: localLevel,\n      }));\n      \n      // Continue monitoring\n      animationFrameRef.current = requestAnimationFrame(updateAudioLevels);\n    };\n    \n    // Start monitoring\n    updateAudioLevels();\n  };\n  \n  // Toggle mute\n  const handleToggleMute = () => {\n    if (webrtcManager) {\n      const newMuteState = webrtcManager.toggleMute();\n      setIsMuted(newMuteState);\n    }\n  };\n  \n  // Toggle video\n  const handleToggleVideo = async () => {\n    if (webrtcManager) {\n      const videoEnabled = await webrtcManager.toggleVideo();\n      setIsVideoEnabled(videoEnabled);\n    }\n  };\n  \n  // Switch camera\n  const handleSwitchCamera = async (deviceId) => {\n    if (webrtcManager) {\n      await webrtcManager.switchCamera(deviceId);\n    }\n  };\n  \n  // Retry camera access\n  const handleRetryCameraAccess = async () => {\n    if (webrtcManager) {\n      const videoEnabled = await webrtcManager.toggleVideo();\n      setIsVideoEnabled(videoEnabled);\n    }\n  };\n  \n  // Leave room\n  const handleLeaveRoom = () => {\n    if (webrtcManager) {\n      webrtcManager.leaveRoom();\n    }\n    \n    if (onLeave) {\n      onLeave();\n    }\n  };\n  \n  // Toggle QR code display\n  const handleToggleQRCode = () => {\n    setShowQRCode((prev) => !prev);\n  };\n  \n  // Generate connection data for QR code\n  const getConnectionData = () => {\n    return JSON.stringify({\n      roomId,\n      server: window.location.origin,\n    });\n  };\n  \n  // Calculate grid columns based on number of participants\n  const getGridColumns = () => {\n    const totalParticipants = 1 + connectedPeers.length; // Local user + peers\n    \n    if (totalParticipants === 1) return 'grid-cols-1';\n    if (totalParticipants === 2) return 'grid-cols-1 md:grid-cols-2';\n    if (totalParticipants <= 4) return 'grid-cols-2';\n    if (totalParticipants <= 6) return 'grid-cols-2 md:grid-cols-3';\n    return 'grid-cols-2 md:grid-cols-3 lg:grid-cols-4';\n  };\n  \n  return (\n    <div className=\"flex flex-col h-full bg-gradient-to-b from-white to-gray-50\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between p-4 border-b border-gray-200 bg-white shadow-sm\">\n        <div className=\"flex items-center space-x-2\">\n          <h2 className=\"text-lg font-medium text-gray-900\">Room: {roomId}</h2>\n          <div className=\"text-sm text-gray-500\">\n            {connectedPeers.length} {connectedPeers.length === 1 ? 'peer' : 'peers'} connected\n          </div>\n          {/* Network quality indicator (Phase 2) */}\n          <div className=\"flex items-center ml-4\">\n            <span className=\"text-sm text-gray-500 mr-2\">Network:</span>\n            <NetworkQualityIndicator quality={networkQuality} />\n            {networkMetrics && (\n              <div className=\"ml-2 text-xs text-gray-500\">\n                {networkMetrics.bitrate ? `${Math.round(networkMetrics.bitrate / 1000)} kbps` : ''}\n                {networkMetrics.rtt ? ` | ${Math.round(networkMetrics.rtt)}ms` : ''}\n              </div>\n            )}\n          </div>\n        </div>\n        \n        <div className=\"flex items-center space-x-2\">\n          <button\n            onClick={handleToggleQRCode}\n            className={clsx(\n              'inline-flex items-center justify-center px-2 py-[calc(--spacing(1.5)-1px)]',\n              'rounded-lg border border-transparent ring-1 shadow-sm ring-black/10',\n              'text-sm font-medium whitespace-nowrap text-gray-950',\n              'data-hover:bg-gray-50'\n            )}\n            aria-label={showQRCode ? \"Hide QR code\" : \"Show QR code for connection\"}\n          >\n            {showQRCode ? \"Hide QR\" : \"Show QR\"}\n          </button>\n          \n          <button\n            onClick={handleToggleMute}\n            className={clsx(\n              'inline-flex items-center justify-center px-4 py-[calc(--spacing(2)-1px)]',\n              'rounded-full border border-transparent shadow-md',\n              'text-base font-medium whitespace-nowrap',\n              isMuted ? \n                'bg-white/15 ring-1 ring-[#D15052]/15 text-gray-950 data-hover:bg-white/20' : \n                'bg-gray-950 text-white data-hover:bg-gray-800',\n              'after:absolute after:inset-0 after:rounded-full after:shadow-[inset_0_0_2px_1px_#ffffff4d]'\n            )}\n            aria-label={isMuted ? \"Unmute microphone\" : \"Mute microphone\"}\n          >\n            {isMuted ? (\n              <>\n                <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"w-5 h-5 mr-2\">\n                  <line x1=\"1\" y1=\"1\" x2=\"23\" y2=\"23\"></line>\n                  <path d=\"M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6\"></path>\n                  <path d=\"M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23\"></path>\n                  <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"23\"></line>\n                  <line x1=\"8\" y1=\"23\" x2=\"16\" y2=\"23\"></line>\n                </svg>\n                Unmute\n              </>\n            ) : (\n              <>\n                <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" className=\"w-5 h-5 mr-2\">\n                  <path d=\"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z\"></path>\n                  <path d=\"M19 10v2a7 7 0 0 1-14 0v-2\"></path>\n                  <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"23\"></line>\n                  <line x1=\"8\" y1=\"23\" x2=\"16\" y2=\"23\"></line>\n                </svg>\n                Mute\n              </>\n            )}\n          </button>\n          \n          <VideoControls \n            isVideoEnabled={isVideoEnabled}\n            onToggleVideo={handleToggleVideo}\n            onSwitchCamera={handleSwitchCamera}\n            videoDevices={videoDevices}\n          />\n          \n          <VideoQualityControls \n            currentQuality={currentVideoQuality}\n            onQualityChange={handleVideoQualityChange}\n          />\n          \n          <button\n            onClick={handleLeaveRoom}\n            className={clsx(\n              'inline-flex items-center justify-center px-4 py-[calc(--spacing(2)-1px)]',\n              'rounded-full border border-transparent bg-[#D15052] shadow-md',\n              'text-base font-medium whitespace-nowrap text-white',\n              'data-hover:bg-[#C04042]'\n            )}\n            aria-label=\"Leave chat room\"\n          >\n            Leave\n          </button>\n        </div>\n      </div>\n      \n      {/* Main content */}\n      <div className=\"flex-1 p-4 overflow-auto\">\n        {isConnecting ? (\n          <div className=\"flex flex-col items-center justify-center h-full\">\n            <div className=\"text-lg font-medium mb-2 text-gray-900\">Connecting...</div>\n            <div className=\"text-sm text-gray-500\">\n              Setting up secure connection\n            </div>\n          </div>\n        ) : error ? (\n          <div className=\"flex flex-col items-center justify-center h-full\">\n            <div className=\"text-lg font-medium text-[#D15052] mb-2\">Error</div>\n            <div className=\"text-sm text-gray-500 mb-4\">{error}</div>\n            <button\n              onClick={handleLeaveRoom}\n              className={clsx(\n                'inline-flex items-center justify-center px-4 py-[calc(--spacing(2)-1px)]',\n                'rounded-full border border-transparent bg-gray-950 shadow-md',\n                'text-base font-medium whitespace-nowrap text-white',\n                'data-hover:bg-gray-800'\n              )}\n            >\n              Go Back\n            </button>\n          </div>\n        ) : (\n          <div className=\"flex flex-col space-y-4\">\n            {/* QR Code */}\n            {showQRCode && (\n              <div className=\"bg-white p-6 rounded-xl shadow-md mx-auto max-w-xs\">\n                <QRCodeGenerator\n                  connectionData={getConnectionData()}\n                  className=\"mx-auto\"\n                />\n                <p className=\"text-center mt-4 text-sm text-gray-500\">\n                  Scan to join this room\n                </p>\n              </div>\n            )}\n            \n            {/* Camera permission guide */}\n            {cameraStatus && cameraStatus.status !== 'granted' && isVideoEnabled && (\n              <CameraPermissionGuide\n                status={cameraStatus.status}\n                instructions={cameraStatus.instructions}\n                browser={cameraStatus.browser?.name}\n                onRetry={handleRetryCameraAccess}\n                className=\"mx-auto max-w-md\"\n              />\n            )}\n            \n            {/* Video grid */}\n            <div className={clsx(\n              'grid gap-4',\n              getGridColumns(),\n              'auto-rows-fr'\n            )}>\n              {/* Local user */}\n              <VideoContainer\n                stream={localVideoStream}\n                isMuted={true}\n                isLocal={true}\n                displayName={userId}\n                isSpeaking={isSpeaking}\n                isVideoEnabled={isVideoEnabled && localVideoStream !== null}\n                connectionQuality={networkQuality}\n                className=\"aspect-video h-full\"\n              />\n              \n              {/* Connected peers */}\n              {connectedPeers.map((peerId) => (\n                <VideoContainer\n                  key={peerId}\n                  stream={remoteVideoStreams[peerId]}\n                  isMuted={false}\n                  isLocal={false}\n                  displayName={peerId}\n                  isSpeaking={peerSpeaking[peerId] || false}\n                  isVideoEnabled={remoteVideoStreams[peerId] !== undefined}\n                  connectionQuality={connectionQualities[peerId]?.quality || 100}\n                  className=\"aspect-video h-full\"\n                />\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default VideoChatRoom;\n\n  // Handle screen sharing change (Phase 3)\n  const handleScreenSharingChange = (isSharing, stream) => {\n    setIsScreenSharing(isSharing);\n    setScreenStream(stream);\n  };\n\n  // Handle toggle screen sharing\n  const handleToggleScreenShare = async () => {\n    if (webrtcManager) {\n      await webrtcManager.toggleScreenSharing();\n    }\n  };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}